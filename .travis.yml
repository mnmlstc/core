language: cpp
sudo: required
before_script: ./scripts/travis-configure
install:       ./scripts/travis-install
script:        cmake --build build --target check -- CTEST_OUTPUT_ON_FAILURE=1
after_success: bash <(curl -s https://codecov.io/bash)

matrix:
  include:

    ### MacOS ###

    # Xcode 8
    - os: osx
      osx_image: xcode8
      compiler: clang
      env: BUILD=Debug
    - os: osx
      osx_image: xcode8
      compiler: clang
      env: BUILD=Release

    # Xcode 7.3
    - os: osx
      osx_image: xcode7.3
      compiler: clang
      env: BUILD=Debug
    - os: osx
      osx_image: xcode7.3
      compiler: clang
      env: BUILD=Release

    # Xcode 6.4
    - os: osx
      osx_image: xcode6.4
      compiler: clang
      env: BUILD=Debug
    - os: osx
      osx_image: xcode6.4
      compiler: clang
      env: BUILD=Release

    ### Linux ###

    # g++-4.8
    - os: linux
      compiler: gcc
      dist: trusty
      env: BUILD=Release GCC_VERSION=4.8
    - os: linux
      compiler: gcc
      dist: trusty
      env: BUILD=Debug GCC_VERSION=4.8

    # g++-4.9
    - os: linux
      compiler: gcc
      dist: trusty
      env: BUILD=Release GCC_VERSION=4.9
    - os: linux
      compiler: gcc
      dist: trusty
      env: BUILD=Debug GCC_VERSION=4.9

    # g++-5
    - os: linux
      compiler: gcc
      dist: trusty
      env: BUILD=Release GCC_VERSION=5
    - os: linux
      compiler: gcc
      dist: trusty
      env: BUILD=Debug GCC_VERSION=5

    # g++-6
    - os: linux
      compiler: gcc
      dist: trusty
      env: BUILD=Release GCC_VERSION=6
    - os: linux
      compiler: gcc
      dist: trusty
      env: BUILD=Debug GCC_VERSION=6

    # clang++-3.4
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Release CLANG_VERSION=3.4
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Debug CLANG_VERSION=3.4
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Release CLANG_VERSION=3.4 USE_LIBCPP=1
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Debug CLANG_VERSION=3.4 USE_LIBCPP=1

    # clang++-3.5
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Release CLANG_VERSION=3.5
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Debug CLANG_VERSION=3.5
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Release CLANG_VERSION=3.5 USE_LIBCPP=1
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Debug CLANG_VERSION=3.5 USE_LIBCPP=1

    # clang++-3.6
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Release CLANG_VERSION=3.6
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Debug CLANG_VERSION=3.6
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Release CLANG_VERSION=3.6 USE_LIBCPP=1
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Debug CLANG_VERSION=3.6 USE_LIBCPP=1

    # clang++-3.8
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Release CLANG_VERSION=3.8
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Debug CLANG_VERSION=3.8
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Release CLANG_VERSION=3.8 USE_LIBCPP=1
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Debug CLANG_VERSION=3.8 USE_LIBCPP=1

    # clang++-3.9
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Release CLANG_VERSION=3.9
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Debug CLANG_VERSION=3.9
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Release CLANG_VERSION=3.9 USE_LIBCPP=1
    - os: linux
      compiler: clang
      dist: trusty
      env: BUILD=Debug CLANG_VERSION=3.9 USE_LIBCPP=1
